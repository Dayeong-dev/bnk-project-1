<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title th:text="${product.name}">예적금 상품 상세</title>
<style>
body {
	font-family: 'Noto Sans KR', sans-serif;
	margin: 0;
	background: #f5f5f5;
}

.container {
	max-width: 1000px;
	margin: 30px auto;
	background: white;
	padding: 30px;
	border-radius: 10px;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

.header h1 {
	margin: 0;
	font-size: 1.8rem;
}

.info-box {
	display: flex;
	justify-content: space-around;
	margin: 20px 0;
	text-align: center;
}

.info-box div {
	font-weight: bold;
	font-size: 1.1rem;
}

.calc-container {
	background: #fefefe;
	padding: 20px;
	border: 1px solid #ccc;
	border-radius: 10px;
	margin: 40px 0;
}

.btn {
	background: #007bff;
	color: white;
	border: none;
	padding: 10px 20px;
	margin: 10px;
	border-radius: 5px;
	cursor: pointer;
}

.btn:hover {
	background: #0056b3;
}

.modal {
	display: none;
	position: fixed;
	z-index: 999;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background: rgba(0, 0, 0, 0.5);
}

.modal-content {
	background: white;
	margin: 5% auto;
	padding: 20px;
	border-radius: 10px;
	width: 90%;
	max-width: 600px;
	max-height: 80vh;
	overflow-y: auto;
}
/* 추가 스타일 (필요 시 head 영역에 포함) */
#detailContent section {
  display: flex;
  align-items: center;
  justify-content: center; /* ✅ 전체를 페이지 가운데 정렬 */
  margin: 50px 0;
  flex-direction: row;
  max-width: 900px; /* ✅ 넓이 제한 */
  margin-left: auto;
  margin-right: auto;
}

#detailContent section.reverse {
  flex-direction: row-reverse;
}

#detailContent section .text-wrap {
  flex: 1;
  padding: 0 20px;
  text-align: left;
}

#detailContent section.reverse .text-wrap {
  text-align: right;
}

#detailContent section h2 {
  font-size: 1.6rem;       /* 기존 1.4 → 더 큼 */
  font-weight: bold;       /* ✅ 볼드 적용 */
  margin-bottom: 10px;
}

#detailContent section p {
  font-size: 1.2rem;       /* 기존 1.1 → 조금 키움 */
  font-weight: 500;        /* ✅ 중간 볼드 (너무 두껍지 않게) */
  line-height: 1.7;
  margin: 0;
}

#detailContent section img {
  width: 240px;
  height: auto;
  border-radius: 8px;
  object-fit: cover;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}




</style>
</head>
<body>
	<!-- 🟢 상단 정보 -->
	<div class="header" style="text-align: center;">
		<h1 th:text="${product.name}" style="margin-bottom: 8px;">상품명</h1>
		<p th:text="${product.summary}" style="font-size: 1rem; color: #666;">상품
			요약</p>
	</div>

	<!-- 🟢 금리/기간 정보 박스 -->
	<div class="info-box">
		<div>
			<span style="color: #d9230f; font-size: 1.4rem;"
				th:text="${#numbers.formatDecimal(product.maxRate,1,'POINT',2,'POINT')} + '%'">4.50%</span><br>
			<small>최고금리</small>
		</div>
		<div>
			<span style="font-size: 1.2rem;"
				th:text="${#numbers.formatDecimal(product.minRate,1,'POINT',2,'POINT')} + '%'">2.50%</span><br>
			<small>최저금리</small>
		</div>
		<div>
			<span style="font-size: 1.2rem;" th:text="${product.period}">12</span>
			개월<br> <small>가입기간</small>
		</div>
	</div>



	<hr>

	<!-- 상세 설명 영역 (7개 섹션 포함) -->
	<div id="detailContent" th:utext="${product.detail}">상세 설명</div>

	</div>

	<div class="calc-container" style="text-align: center;">
		<h3 style="font-size: 1.5rem; margin-bottom: 20px;">💰 간편 이자 계산기</h3>

		<div
			style="display: inline-flex; flex-wrap: wrap; align-items: center; gap: 15px; font-size: 1.2rem; justify-content: center;">
			<label> 이 상품을 <input id="monthsInput" type="text"
				th:value="${product.period}"
				style="width: 60px; padding: 10px; text-align: right; font-size: 1.1rem;" />
				<span>개월 간</span>
			</label> <label> <input id="depositAmount" type="text"
				value="1,000,000"
				style="width: 170px; padding: 10px; text-align: right; font-size: 1.1rem;" />
				<span>원으로</span>
			</label> <label> 금리 연 <input id="rateInput" type="text"
				th:value="${#numbers.formatDecimal(product.maxRate,1,'POINT',2,'POINT')}"
				style="width: 70px; padding: 10px; text-align: right; font-size: 1.1rem;" />
				<span>%를 적용하면?</span>
			</label>
		</div>

		<br>
		<button class="btn" style="margin-top: 20px;" onclick="calcInterest()">✔
			결과보기</button>

		<div style="margin-top: 25px; font-size: 1.3rem;">
			세전 이자: <b id="interestResult"
				style="font-size: 1.5rem; color: #1565c0;">0</b> 원
		</div>
	</div>

	<div style="text-align: center;">
		<a href="/deposit/list" class="btn">목록으로</a>
		<button class="btn" onclick="openModal()">상품 이용 가이드</button>
		<button class="btn" onclick="openRateModal()">금리표 보기</button>
	</div>


	<!-- 모달창 -->
	<div id="productModal" class="modal">
		<div class="modal-content" style="position: relative;">
			<span class="close" onclick="closeModal()">&times;</span>
			<h2 style="text-align: center; margin-top: 0;">상품 이용 가이드</h2>
			<div th:utext="${modalDetailForModal}" style="margin-bottom: 20px;">가이드
				내용</div>

			<!-- ✅ 하단 닫기 버튼 -->
			<div style="text-align: center;">
				<button class="btn" onclick="closeModal()">닫기</button>
			</div>
		</div>
	</div>
	
	<!-- 금리표 모달 -->
<div id="rateModal" class="modal">
  <div class="modal-content" style="position: relative;">
    <span class="close" onclick="closeRateModal()">&times;</span>
    <h2 style="text-align: center; margin-top: 0;">금리표</h2>
    <div th:utext="${modalRateTable}" style="margin-bottom: 20px;">
      <!-- 금리표 HTML 출력 -->
    </div>
    <div style="text-align: center;">
      <button class="btn" onclick="closeRateModal()">닫기</button>
    </div>
  </div>
</div>
	

	<script>
  function openModal() {
    document.getElementById("productModal").style.display = "block";
  }
  function closeModal() {
    document.getElementById("productModal").style.display = "none";
  }
  window.onclick = function(e) {
    if (e.target == document.getElementById("productModal")) {
      closeModal();
    }
  }
  
  function openRateModal() {
	  document.getElementById("rateModal").style.display = "block";
	}
	function closeRateModal() {
	  document.getElementById("rateModal").style.display = "none";
	}
	window.onclick = function(e) {
	  if (e.target === document.getElementById("productModal")) closeModal();
	  if (e.target === document.getElementById("rateModal")) closeRateModal();
	};

  // 쉼표 자동 삽입
 document.getElementById("depositAmount").addEventListener("input", function() {
  const val = this.value.replace(/,/g, '').replace(/\D/g, '');
  this.value = Number(val).toLocaleString();
});

function calcInterest() {
  const amount = Number(document.getElementById("depositAmount").value.replace(/,/g, ''));
  const months = Number(document.getElementById("monthsInput").value);
  const rate = Number(document.getElementById("rateInput").value);

  if (isNaN(amount) || isNaN(months) || isNaN(rate)) {
    alert("모든 값을 숫자로 입력해주세요.");
    return;
  }

  const interest = (amount * rate * months) / (12 * 100);
  document.getElementById("interestResult").innerText = Math.floor(interest).toLocaleString();
}


  
  
window.addEventListener("load", () => {
	  const sections = document.querySelectorAll("#detailContent section");

	  sections.forEach((section, i) => {
	    const h2 = section.querySelector("h2");
	    const p = section.querySelector("p");
	    const img = section.querySelector("img");

	    if (h2 && p && img) {
	      const wrapper = document.createElement("div");
	      wrapper.className = "text-wrap";
	      wrapper.appendChild(h2);
	      wrapper.appendChild(p);
	      section.insertBefore(wrapper, img);
	    }

	    // 짝수번째 reverse 적용
	    if ([2, 4, 6].includes(i + 1)) {
	      section.classList.add("reverse");
	    }
	  });
	});


</script>
</body>
</html>
